export const TOPIC_PROMPT_TEMPLATE = `당신은 SuanLab의 기술 블로그 작가입니다. 다음 주제에 대해 한국어로 고품질의 블로그 포스트를 작성해주세요.

## 주제
{{TOPIC}}

## 카테고리
{{CATEGORY}}

## 요청된 태그
{{TAGS}}

## 작성 지침

### 독자 대상
- 데이터 과학/AI에 관심있는 대학생 및 현업 개발자
- 기본적인 프로그래밍 지식을 갖춘 독자

### 분량
- 1500-2500 단어

### 구조
1. **도입부**: 주제 소개 및 왜 중요한지 설명
2. **본문**: 핵심 개념을 단계별로 설명, 코드 예제 포함 (Python 권장)
3. **결론**: 요약 및 추가 학습 자료 안내

### 스타일 가이드
- 친근하면서도 전문적인 톤 유지
- 코드 예제는 실행 가능하고 주석을 포함
- 수식은 반드시 다음 형식 사용:
  - 인라인 수식: \`$수식$\` (예: \`$x^2 + y^2 = z^2$\`)
  - 블록 수식: \`$$수식$$\` (예: \`$$\\sum_{i=1}^{n} x_i$$\`)
  - 절대 \`( ... )\` 또는 \`\\( ... \\)\` 형식 사용 금지
- 전문 용어는 처음 등장 시 한글(영어) 형태로 표기
- 참고 자료 링크 포함

## 출력 형식
- Frontmatter 없이 마크다운 본문만 작성
- 제목은 \`#\`로 시작하는 첫 번째 헤딩으로 작성
- 섹션은 \`##\`로 구분
`;

export const PAPER_SUMMARY_PROMPT = `당신은 세계적 수준의 AI/ML 연구자이자 논문 리뷰 전문가입니다. 다음 논문을 **학술적 깊이**와 **실무적 통찰**을 갖춘 포괄적인 블로그 포스트로 작성해주세요.

## 논문 정보
- 제목: {{TITLE}}
- 저자: {{AUTHORS}}
- 발표일: {{DATE}}
- arXiv ID: {{ARXIV_ID}}

## 논문 본문
{{PAPER_CONTENT}}

## 작성 지침

### 핵심 원칙
1. **깊이 있는 분석**: 표면적 요약이 아닌 핵심 기여와 기술적 혁신을 심층 분석
2. **비판적 평가**: 장점뿐 아니라 한계점, 가정의 타당성, 재현 가능성을 객관적으로 평가
3. **맥락적 이해**: 해당 분야의 발전 흐름 속에서 논문의 위치와 의의를 설명
4. **실용적 가치**: 연구자와 실무자가 실제로 활용할 수 있는 인사이트 제공

### 분량 (매우 중요!)
- **최소 5000단어 이상** (한국어 기준 약 25-30분 읽기 분량)
- 각 섹션을 충실하게 작성하고, 피상적인 설명 금지
- 논문의 핵심 수식은 **모두** 포함하고 상세히 설명

### 구조 (각 섹션별 최소 분량 준수)

1. **TL;DR** (5-7문장):
   - 논문이 해결하는 핵심 문제
   - 제안하는 해결책의 핵심 아이디어
   - 주요 실험 결과와 수치
   - 이 연구의 학술적/실무적 의의

2. **연구 배경 및 동기** (최소 500단어):
   - 해당 분야의 현재 상황과 주요 과제
   - 기존 접근법들의 **구체적인** 한계점 (논문에서 언급된 내용 인용)
   - 이 연구가 필요한 이유와 해결하고자 하는 gap
   - 연구 질문(Research Questions) 명시

3. **관련 연구 심층 분석** (최소 400단어):
   - 주요 선행 연구 **최소 5개 이상** 언급 및 설명
   - 각 연구의 접근 방식과 한계점
   - 본 논문과의 차별점을 **표로 정리**
   - 기술적 계보(lineage) 설명

4. **핵심 기여 (Key Contributions)** (최소 300단어):
   - 논문의 주요 기여점을 **번호 목록**으로 명확히 정리
   - 각 기여의 novelty와 중요성 설명
   - 기존 방법 대비 개선점 정량화

5. **제안 방법론 상세 분석** (최소 1000단어):

   ### 5.1 핵심 아이디어
   - 방법론의 직관적 설명 (비유나 예시 활용)
   - 왜 이 접근법이 효과적인지 이론적 근거

   ### 5.2 모델 아키텍처
   - 전체 구조를 **ASCII 다이어그램** 또는 상세 텍스트로 설명
   - 각 컴포넌트의 역할과 상호작용
   - 기존 아키텍처와의 차이점

   ### 5.3 핵심 수식 및 알고리즘
   - 논문의 **모든 중요 수식** 포함 (최소 5개 이상)
   - 각 수식의 의미, 각 항(term)의 역할 상세 설명
   - 수식 간의 관계와 유도 과정
   - 알고리즘 pseudo-code 포함

   ### 5.4 구현 세부사항
   - **실행 가능한 Python/PyTorch 코드** (최소 50줄 이상)
   - 코드에 **상세한 주석** 포함
   - 핵심 모듈의 실제 구현 예시

6. **실험 설계 및 설정** (최소 500단어):

   ### 6.1 데이터셋
   - 사용된 모든 데이터셋의 상세 정보
   - 데이터 전처리 방법
   - Train/Val/Test 분할 정보

   ### 6.2 평가 지표
   - 사용된 모든 메트릭 설명
   - 각 메트릭을 선택한 이유
   - 메트릭의 수식 정의

   ### 6.3 베이스라인 및 비교 모델
   - 비교 대상 모델들의 간략한 설명
   - 공정한 비교를 위한 조건

   ### 6.4 하이퍼파라미터
   - 주요 하이퍼파라미터 **표로 정리**
   - 하이퍼파라미터 선택 근거

7. **실험 결과 심층 분석** (최소 700단어):

   ### 7.1 메인 결과
   - 주요 결과를 **마크다운 표**로 정리
   - 베이스라인 대비 성능 향상률(%) 계산
   - 통계적 유의성 언급

   ### 7.2 심층 분석
   - 왜 제안 방법이 더 좋은 성능을 보이는지 분석
   - 어떤 상황에서 특히 효과적인지
   - 실패 케이스 분석 (있는 경우)

   ### 7.3 Ablation Study
   - 각 컴포넌트의 기여도 분석
   - 결과를 **표로 정리**
   - 어떤 요소가 가장 중요한지 인사이트

   ### 7.4 추가 분석
   - Visualization 결과 설명
   - 계산 비용/효율성 분석
   - 확장성(Scalability) 분석

8. **비판적 평가** (최소 400단어):

   ### 8.1 강점
   - 기술적 강점 3-5개 상세 설명

   ### 8.2 약점 및 한계
   - 방법론적 한계
   - 실험 설계의 한계
   - 일반화 가능성에 대한 우려
   - 재현성 이슈 (코드/데이터 공개 여부)

   ### 8.3 가정의 타당성
   - 논문에서 사용한 가정들
   - 이 가정들이 실제 상황에서 유효한지

9. **향후 연구 방향** (최소 300단어):
   - 저자가 제안한 future work
   - 리뷰어가 생각하는 확장 가능성
   - 다른 도메인/태스크 적용 가능성
   - 해결되지 않은 open questions

10. **실무 적용 가이드** (최소 300단어):
    - 이 연구를 실제로 적용할 때 고려사항
    - 산업계에서의 활용 시나리오
    - 구현 시 주의점과 팁
    - 필요한 컴퓨팅 리소스 추정

11. **결론** (최소 200단어):
    - 핵심 기여 재요약
    - 해당 분야에 미칠 영향
    - 개인적인 평가와 추천

12. **참고 자료**:
    - 논문 링크
    - 공식 코드 저장소 (있는 경우)
    - 관련 블로그/튜토리얼
    - 추천 후속 논문 3-5개

### 스타일 가이드
- 전문 용어는 처음 등장 시 **한글(영어)** 형태로 표기
- 수식은 반드시 다음 형식 사용:
  - 인라인 수식: \`$수식$\` (예: \`$x^2 + y^2 = z^2$\`)
  - 블록 수식: \`$$수식$$\` (예: \`$$\\sum_{i=1}^{n} x_i$$\`)
  - **절대** \`( ... )\` 또는 \`\\( ... \\)\` 형식 사용 금지
- 중요한 내용은 **굵게** 또는 *기울임*으로 강조
- 복잡한 비교는 **표**를 활용
- 논문 원문 인용 시 > 블록인용 사용
- 코드 블록에는 **상세한 주석** 필수

### 품질 체크리스트
작성 후 다음을 확인하세요:
- [ ] 5000단어 이상인가?
- [ ] 핵심 수식이 5개 이상 포함되었는가?
- [ ] Python 코드가 50줄 이상인가?
- [ ] 표가 3개 이상 포함되었는가?
- [ ] 관련 연구가 5개 이상 언급되었는가?
- [ ] 비판적 평가가 구체적인가?

## 출력 형식
- Frontmatter 없이 마크다운 본문만 작성
- 제목은 \`# [논문 리뷰] 논문제목\` 형식으로 시작
- 섹션은 \`##\`로 구분, 하위 섹션은 \`###\`로 구분
`;

export const PAPER_CHUNK_SUMMARY_PROMPT = `다음은 학술 논문의 일부입니다. 핵심 내용을 요약해주세요.

## 논문 내용
{{CHUNK}}

## 요약 지침
다음 사항에 집중하여 요약해주세요:
1. 주요 개념과 정의
2. 제안하는 방법론
3. 수식과 알고리즘 (있는 경우)
4. 실험 설정과 결과 (있는 경우)

간결하지만 중요한 세부사항은 놓치지 마세요. 한국어로 작성해주세요.
`;

export const SYNTHESIS_PROMPT = `다음은 논문의 여러 부분을 요약한 것입니다. 이를 통합하여 완전한 블로그 포스트를 작성해주세요.

## 논문 메타데이터
{{METADATA}}

## 섹션별 요약
{{SUMMARIES}}

## 작성 지침
${PAPER_SUMMARY_PROMPT.split('## 작성 지침')[1]}
`;

export function buildTopicPrompt(options: {
  topic: string;
  category?: string;
  tags?: string[];
}): string {
  return TOPIC_PROMPT_TEMPLATE.replace('{{TOPIC}}', options.topic)
    .replace('{{CATEGORY}}', options.category || 'General')
    .replace('{{TAGS}}', (options.tags || []).join(', ') || '자동 생성');
}

export function buildPaperPrompt(options: {
  title: string;
  authors: string;
  date: string;
  arxivId: string;
  content: string;
}): string {
  return PAPER_SUMMARY_PROMPT.replace('{{TITLE}}', options.title)
    .replace('{{AUTHORS}}', options.authors)
    .replace('{{DATE}}', options.date)
    .replace('{{ARXIV_ID}}', options.arxivId || 'N/A')
    .replace('{{PAPER_CONTENT}}', options.content);
}

export function buildChunkPrompt(chunk: string): string {
  return PAPER_CHUNK_SUMMARY_PROMPT.replace('{{CHUNK}}', chunk);
}

export function buildSynthesisPrompt(
  metadata: string,
  summaries: string[]
): string {
  return SYNTHESIS_PROMPT.replace('{{METADATA}}', metadata).replace(
    '{{SUMMARIES}}',
    summaries.map((s, i) => `### Part ${i + 1}\n${s}`).join('\n\n')
  );
}
