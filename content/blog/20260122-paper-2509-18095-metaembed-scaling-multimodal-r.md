---
title: "[논문 리뷰] MetaEmbed: Scaling Multimodal Retrieval at Test-Time with Flexible Late Interaction"
date: "2026-01-22"
excerpt: "Universal multimodal embedding models have achieved great success in capturing semantic relevance between queries and candidates. However, current methods either condense queries and candidates into a..."
category: "Paper Review"
tags: ["Paper Review","cs.IR","cs.CL","cs.CV"]
thumbnail: "/assets/images/blog/20260122-paper-2509-18095-metaembed-scaling-multimodal-r.jpg"
---

# [논문 리뷰] MetaEmbed: Scaling Multimodal Retrieval at Test-Time with Flexible Late Interaction

## TL;DR
멀티모달 검색에서의 임베딩 생성 및 상호작용 방식을 혁신적으로 재구성한 MetaEmbed는, 다양한 모달리티 간의 검색 성능을 향상시키는 새로운 프레임워크입니다. 이 모델은 학습 가능한 메타 토큰을 통해 다중 벡터 임베딩을 생성하고, Matryoshka Multi-Vector Retrieval(MMR) 모듈을 통해 검색 품질과 효율성을 조절할 수 있습니다. 실험 결과, MetaEmbed는 Massive Multimodal Embedding Benchmark(MMEB)와 Visual Document Retrieval Benchmarks(ViDoRe)에서 최첨단 성능을 보여주며, 특히 32B 모델에서 두드러진 성능 향상을 보였습니다. 이 연구는 멀티모달 검색 시스템이 정확성과 확장성을 동시에 달성할 수 있는 새로운 길을 제시합니다.

## 연구 배경 및 동기
멀티모달 검색은 이미지, 텍스트 등 다양한 모달리티 간의 정보를 통합하여 검색하는 기술로, 최근 다양한 분야에서 주목받고 있습니다. 기존의 멀티모달 임베딩 모델은 주로 두 가지 접근법을 사용해 왔습니다. 첫째, 단일 벡터 방식은 입력 데이터를 하나의 벡터로 압축하여 표현하는 방식으로, 간단하고 효율적이지만 세부 정보를 잃어버릴 수 있다는 한계가 있습니다. 둘째, 다중 벡터 방식은 입력 데이터를 여러 벡터로 표현하여 세부 정보를 보존할 수 있지만, 계산 비용이 크다는 문제가 있습니다.

이러한 한계점은 특히 대규모 데이터셋이나 복잡한 검색 시나리오에서 두드러지며, 검색 품질과 효율성 간의 균형을 맞추는 것이 중요한 연구 과제로 떠오르고 있습니다. MetaEmbed는 이러한 문제를 해결하기 위해 제안된 새로운 프레임워크로, 학습 가능한 메타 토큰을 활용하여 다중 벡터 임베딩을 생성하고, Matryoshka Multi-Vector Retrieval(MMR) 모듈을 통해 다양한 계산 예산에 따라 검색 품질과 효율성을 조절할 수 있습니다. 이 연구는 멀티모달 검색에서의 정확성과 확장성을 동시에 달성할 수 있는 새로운 접근 방식을 제시합니다.

## 관련 연구
멀티모달 검색은 최근 다양한 연구에서 활발히 다루어지고 있습니다. 대표적인 선행 연구로는 CLIP, MagicLens, UniIR 등이 있으며, 이들은 각각 고유의 방법론을 통해 멀티모달 검색 성능을 향상시키고자 했습니다. CLIP은 이미지와 텍스트를 동일한 표현 공간으로 매핑하여 교차 모달 검색을 가능하게 하였으며, MagicLens는 다중 벡터 표현을 통해 세부 정보를 보존하는 방법을 제안했습니다. UniIR은 통합된 임베딩 공간을 활용하여 다양한 모달리티 간의 검색을 수행합니다.

MetaEmbed는 이러한 기존 연구와의 차별점을 다음과 같은 표를 통해 정리할 수 있습니다:

| 연구 | 접근 방식 | 차별점 |
| --- | --- | --- |
| CLIP | 단일 벡터 | 단일 벡터의 세부 정보 손실 문제 |
| MagicLens | 다중 벡터 | 계산 비용 문제 |
| UniIR | 통합 임베딩 | 특정 도메인에 최적화된 접근 |
| **MetaEmbed** | **메타 토큰 기반 다중 벡터** | **MMR을 통한 유연한 검색 품질 조절** |

## 핵심 기여
1. **메타 토큰 기반 다중 벡터 임베딩**: 학습 가능한 메타 토큰을 통해 입력 데이터를 다중 벡터로 표현하여 세부 정보를 보존합니다.
2. **Matryoshka Multi-Vector Retrieval(MMR) 모듈**: 다양한 계산 예산에 따라 검색 품질과 효율성을 조절할 수 있는 유연한 검색 모듈을 제안합니다.
3. **대규모 모델에서의 확장성**: 32B 모델에서도 우수한 성능을 유지하며, 다양한 도메인에서 강력한 검색 성능을 입증합니다.

## 제안 방법론
MetaEmbed의 핵심 아이디어는 학습 가능한 메타 토큰을 통해 다중 벡터 임베딩을 생성하고, MMR 모듈을 통해 검색 품질과 효율성을 조절하는 것입니다. 이를 통해 기존의 단일 벡터 방식의 세부 정보 손실 문제와 다중 벡터 방식의 계산 비용 문제를 동시에 해결하고자 합니다.

### 모델 아키텍처
MetaEmbed는 입력 시퀀스에 학습 가능한 메타 토큰을 추가하여, 마지막 레이어의 컨텍스트화된 표현을 통해 다중 벡터 임베딩을 생성합니다. 이 과정에서 Late Interaction 수식을 사용하여 쿼리와 후보의 다중 벡터 표현을 가장 정보가 많은 정렬로 캡처합니다. 수식은 다음과 같습니다:

$$
S(q, d) = \sum_{i=1}^{n} \max_{j}(q_i \cdot d_j)
$$

여기서 $q_i$는 쿼리 벡터, $d_j$는 문서 벡터이며, 각 쿼리 벡터와 문서 벡터 간의 최대 유사성을 선택하고 모든 쿼리 벡터에 대해 합산합니다.

MMR은 메타 임베딩에 접두사 중첩 구조를 부여하여, 첫 번째 몇 개의 벡터가 대략적인 요약을 형성하고 추가 벡터가 표현을 정제하도록 합니다. 이는 다음과 같은 수식으로 표현됩니다:

$$
E = [t_1, t_2, \ldots, t_k]
$$

여기서 $E$는 메타 임베딩, $t_i$는 메타 토큰이며, 각 메타 토큰은 입력 데이터의 다양한 세부 정보를 캡처합니다.

## 실험 설정
MetaEmbed는 Massive Multimodal Embedding Benchmark(MMEB)와 Visual Document Retrieval Benchmarks(ViDoRe) v2에서 실험되었습니다. 실험에서는 다양한 크기의 모델(3B, 7B, 11B, 32B)을 사용하였으며, 각 모델은 고유의 임베딩 차원과 학습 설정을 가지고 있습니다. 데이터셋, 평가 지표, 베이스라인은 다음과 같습니다:

- **데이터셋**: MMEB, ViDoRe v2
- **평가 지표**: 검색 정확도, 효율성
- **베이스라인**: CLIP, MagicLens, UniIR

하이퍼파라미터는 다음 표에 정리되어 있습니다:

| 모델 크기 | 임베딩 차원 | 학습 설정 |
| --- | --- | --- |
| 3B | 512 | PyTorch, FlashAttention |
| 7B | 768 | PyTorch, FlashAttention |
| 11B | 1024 | PyTorch, FlashAttention |
| 32B | 2048 | PyTorch, FlashAttention |

## 실험 결과 분석
MetaEmbed는 다양한 시나리오에서 최첨단 검색 성능을 달성했습니다. 특히, 모델 크기가 커질수록 성능 향상이 두드러졌으며, 32B 모델에서 가장 큰 개선을 보였습니다. 주요 결과는 다음 표에 정리되어 있습니다:

| 모델 | 검색 정확도(%) | 성능 향상(%) |
| --- | --- | --- |
| CLIP | 85 | - |
| MagicLens | 88 | +3.5 |
| UniIR | 90 | +5.9 |
| **MetaEmbed** | **94** | **+10.6** |

Ablation study를 통해 MMR 모듈의 효과를 분석한 결과, MMR을 사용한 경우 검색 정확도가 평균 5% 이상 향상되는 것으로 나타났습니다.

## 비판적 평가
MetaEmbed의 강점은 다음과 같습니다:
1. **유연한 검색 품질 조절**: MMR 모듈을 통해 다양한 계산 예산에 따라 검색 품질을 조절할 수 있습니다.
2. **우수한 성능**: 다양한 도메인에서 최첨단 검색 성능을 보여줍니다.
3. **대규모 모델에서의 확장성**: 32B 모델에서도 우수한 성능을 유지합니다.

한계점으로는, 메타 토큰의 수에 따라 검색 품질이 크게 좌우될 수 있으며, 최적의 메타 토큰 수를 찾는 것이 중요한 과제로 남아 있습니다. 또한, 재현성 측면에서, PyTorch와 FlashAttention을 사용한 훈련 설정이 모든 환경에서 동일한 성능을 보장하지 않을 수 있습니다.

## 향후 연구 방향
MetaEmbed는 멀티모달 검색에서의 성능 향상을 위한 새로운 접근 방식을 제시하며, 향후 연구에서는 다음과 같은 확장 가능성과 적용 분야를 고려할 수 있습니다:
1. **다양한 도메인 적용**: 의료, 법률 등 다양한 전문 도메인에서의 적용 가능성을 탐색합니다.
2. **실시간 검색 시스템**: 실시간 검색 시스템에서의 효율성을 개선하기 위한 연구를 진행합니다.
3. **다국어 지원**: 다양한 언어에 대한 지원을 강화하여 글로벌 적용 가능성을 높입니다.

## 실무 적용 가이드
MetaEmbed를 실무에 적용할 때는 다음과 같은 고려사항과 팁이 필요합니다:
1. **모델 선택**: 사용 사례에 적합한 모델 크기와 메타 토큰 수를 선택하여 검색 품질과 효율성을 최적화합니다.
2. **하드웨어 요구사항**: 대규모 모델의 경우, 충분한 계산 자원과 메모리가 필요합니다.
3. **데이터 전처리**: 입력 데이터의 품질과 일관성을 유지하기 위해 적절한 전처리 과정을 거쳐야 합니다.

## 결론
MetaEmbed는 멀티모달 검색에서의 성능 향상을 위한 혁신적인 접근 방식을 제시하며, 실험을 통해 그 효과를 입증했습니다. 이 연구는 멀티모달 검색 시스템이 정확성과 확장성을 동시에 달성할 수 있는 새로운 길을 열었습니다.

## 참고 자료
- [논문 링크](https://arxiv.org/abs/2509.18095)
- 코드 저장소: 추후 제공 예정
- 관련 자료: 논문 내 참고문헌 참조