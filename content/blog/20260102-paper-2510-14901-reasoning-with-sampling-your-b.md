---
title: "[논문 리뷰] Reasoning with Sampling: Your Base Model is Smarter Than You Think"
date: "2026-01-02"
excerpt: "Frontier reasoning models have exhibited incredible capabilities across a wide array of disciplines, driven by posttraining large language models (LLMs) with reinforcement learning (RL). However, desp..."
category: "Paper Review"
tags: ["Paper Review","cs.LG","cs.AI","cs.CL"]
thumbnail: "/assets/images/blog/20260102-paper-2510-14901-reasoning-with-sampling-your-b.jpg"
---

# [논문 리뷰] Reasoning with Sampling: Your Base Model is Smarter Than You Think

## TL;DR

대규모 언어 모델(LLM)의 추론 능력을 강화하기 위해, 기존의 강화 학습(RL)을 통한 후처리 대신, 기본 모델에서 순수 샘플링을 활용하는 새로운 방법론을 제안합니다. 이 방법론은 마코프 체인 몬테카를로(MCMC) 기법을 사용하여 모델의 확률 분포를 강화하고, 중요한 토큰을 강조하여 추론 성능을 향상시킵니다. 실험 결과, 제안된 샘플링 알고리즘은 다양한 벤치마크에서 RL 후처리와 유사하거나 더 나은 성능을 보였으며, 응답의 다양성도 유지했습니다. 이는 LLM의 잠재력을 최대한 활용하여 리소스 효율적인 추론 능력 향상에 기여할 수 있음을 시사합니다. 특히, 별도의 추가 학습 없이 기존 모델의 성능을 끌어올린다는 점에서 주목할 만합니다.

## 연구 배경 및 동기

대규모 언어 모델(LLM)은 최근 인공지능 연구에서 중요한 발전을 이루어 왔으며, 다양한 분야에서 뛰어난 성능을 보여주고 있습니다. 이러한 모델들은 주로 대량의 데이터로 사전 학습된 후, 특정 작업에 맞춰 강화 학습(RL)을 통해 후처리되어 성능을 최적화합니다. 그러나 RL 기반의 후처리는 몇 가지 한계점을 가지고 있습니다. 첫째, RL은 대규모의 연산 자원을 필요로 하며, 이는 비용과 시간이 많이 소요되는 작업입니다. 둘째, RL 후처리는 종종 모델의 다양성을 감소시키고, 특정한 패턴에 과적합되는 경향이 있습니다. 예를 들어, 특정 벤치마크에 지나치게 최적화되어 일반적인 상황에서의 성능이 저하될 수 있습니다.

이 연구는 이러한 한계점을 해결하기 위해, 기본 모델 자체의 잠재력을 최대한 활용하는 방법을 탐구합니다. 구체적으로, 추가적인 훈련 없이 순수 샘플링을 통해 기본 모델에서 유사한 수준의 추론 능력을 이끌어낼 수 있는지를 조사합니다. 이는 모델이 이미 학습한 정보를 기반으로, 확률 분포를 샤프닝(sharpening)하여 더 확신 있는 답변을 생성하는 접근 방식입니다. 이를 통해, RL 후처리에 의존하지 않고도 높은 성능을 달성할 수 있는 가능성을 제시합니다. 이는 LLM의 활용에 있어 비용 효율성을 높이는 중요한 시도입니다.

## 관련 연구

이 논문은 언어 모델의 샘플링 전략을 개선하기 위한 다양한 최신 연구와 방법론을 다루고 있습니다. 다음은 본 논문과 관련된 주요 선행 연구들입니다:

1. **GPT-3**: 대규모 언어 모델의 대표적인 예시로, 사전 학습된 모델을 다양한 작업에 적용하는 방법론을 제시했습니다. 그러나 이 연구는 RL 후처리를 통해 모델 성능을 개선하는 방법론을 중심으로 하고 있습니다. OpenAI의 InstructGPT와 같이, 인간 피드백을 활용한 RLHF(Reinforcement Learning from Human Feedback) 방식이 대표적입니다.

2. **BERT**: 사전 학습된 언어 모델을 다양한 자연어 처리 작업에 적용하는 방법을 제시했으며, 특히 문맥 이해 능력을 강조했습니다. 본 논문은 샘플링을 통한 추론 능력 향상에 초점을 맞추고 있습니다. BERT는 마스크된 언어 모델링(Masked Language Modeling)을 통해 문맥적 의미를 파악하는 데 강점을 보입니다.

3. **MCMC 기법**: 복잡한 확률 분포에서 샘플을 효율적으로 추출하는 통계적 방법으로, 본 논문의 샘플링 알고리즘의 기반이 됩니다. MCMC는 특히 고차원 데이터에서 확률 분포를 근사하는 데 유용합니다.

4. **강화 학습(RL)**: 모델의 성능을 향상시키기 위해 널리 사용되는 방법론으로, 본 논문은 RL 없이도 유사한 성능을 이끌어낼 수 있는 가능성을 탐구합니다. PPO(Proximal Policy Optimization)와 같은 알고리즘이 LLM의 RL 후처리에 자주 사용됩니다.

5. **확산 모델**: 확률적 샘플링을 통해 데이터의 다양성을 유지하는 방법론으로, 본 논문은 응답 다양성을 유지하면서도 높은 성능을 달성하는 방법을 제안합니다. 확산 모델은 이미지 생성 분야에서 뛰어난 성능을 보이며, 최근에는 텍스트 생성에도 활용되고 있습니다.

이 논문은 기존의 RL 기반 접근법과 달리, 샘플링을 통해 모델의 잠재력을 최대한 활용하는 방법론을 제시하며, 이는 리소스 효율적인 추론 능력 향상에 기여할 수 있습니다. 특히, RL의 복잡한 학습 과정 없이, 기존 모델의 inference 단계에서 바로 적용 가능하다는 장점이 있습니다.

| 연구 | 접근법 | 차별점 |
|------|--------|--------|
| GPT-3 | 사전 학습 및 RL 후처리 | 샘플링을 통한 추론 강화 |
| BERT | 문맥 이해 중심 | 샘플링 전략 개선 |
| MCMC | 통계적 샘플링 | 파워 샘플링 도입 |
| RL | 성능 향상 | RL 없이 성능 향상 |
| 확산 모델 | 데이터 다양성 유지 | 응답 다양성 유지 |

## 핵심 기여

1. **순수 샘플링을 통한 추론 강화**: 기본 모델의 잠재력을 최대한 활용하여, 추가적인 훈련 없이도 높은 성능을 달성할 수 있는 가능성을 제시합니다. 이는 LLM 운영 비용을 절감하고, 모델 개발 주기를 단축하는 데 기여할 수 있습니다.

2. **파워 샘플링 알고리즘 제안**: 마코프 체인 몬테카를로(MCMC) 기법을 활용하여, 모델의 확률 분포를 샤프닝하고 중요한 토큰을 강조하는 새로운 샘플링 알고리즘을 제안합니다. 이 알고리즘은 모델이 더 '확신'하는 답변을 생성하도록 유도합니다.

3. **다양성 유지**: 제안된 샘플링 방법은 RL 후처리에서 발생할 수 있는 다양성 붕괴를 피하면서도 높은 정확도를 유지합니다. 이는 모델이 다양한 상황에 유연하게 대처할 수 있도록 돕습니다.

4. **광범위한 적용 가능성**: 제안된 방법은 훈련, 검증 데이터셋, 검증기가 필요하지 않으며, 다양한 도메인과 태스크에 적용 가능합니다. 이는 LLM의 활용 범위를 넓히는 데 기여할 수 있습니다.

5. **실험적 검증**: 다양한 벤치마크에서의 실험을 통해, 제안된 방법론의 유효성을 입증하고, RL 후처리와 유사하거나 더 나은 성능을 보임을 확인했습니다. 특히, 도메인 외(out-of-domain) 데이터에 대한 성능 향상이 두드러집니다.

## 제안 방법론

본 논문에서는 기본 모델의 확률 분포를 활용하여 추론 능력을 강화하는 새로운 샘플링 알고리즘을 제안합니다. 핵심 아이디어는 모델의 확률 분포를 샤프닝하여, 더 확신 있는 답변을 생성하는 것입니다. 이를 위해, 마코프 체인 몬테카를로(MCMC) 기법을 사용하여 파워 분포에서 샘플링합니다. MCMC는 복잡한 확률 분포에서 샘플을 추출하는 데 효과적인 방법입니다.

### 모델 아키텍처

제안된 방법론은 기본 모델의 확률 분포를 기반으로 하며, 다음과 같은 과정으로 이루어집니다:

1. **분포 샤프닝**: 기본 모델의 확률 분포를 강화하여, 높은 가능성의 영역을 강조합니다. 이는 모델이 더 '확신'하는 답변에 집중하도록 유도합니다.

2. **파워 분포**: 기본 모델의 분포를 지수화하여 높은 가능성의 시퀀스를 더 강조합니다. 예를 들어, 모델이 "A"를 0.6, "B"를 0.4로 예측했다면, $\alpha = 2$일 때 파워 분포는 "A"를 0.6^2 = 0.36, "B"를 0.4^2 = 0.16으로 만들어 "A"에 더욱 집중하게 됩니다. 이는 모델의 confidence를 증폭시키는 효과를 가집니다.

3. **MCMC 샘플링 알고리즘**: 마코프 체인 몬테카를로 기법을 사용하여 파워 분포에서 샘플링합니다. 이 방법은 기본 모델의 가능성을 활용하여 순차적으로 토큰 서브시퀀스를 재샘플링합니다. 구체적으로, Metropolis-Hastings 알고리즘을 사용하여 새로운 샘플을 제안하고, 수락 여부를 결정합니다.

4. **메트로폴리스-헤이스팅스 알고리즘**: 비정규화된 확률 분포에서 샘플링하기 위한 MCMC의 한 종류로, 제안된 샘플이 기존 샘플보다 높은 가능성을 가지면 채택하는 방식입니다. 이 알고리즘은 수락 확률을 계산하여 샘플을 채택할지 여부를 결정합니다.

### 핵심 수식

1. **파워 분포 수식**:
   $$ p_{\alpha}(x) \propto p(x)^{\alpha} $$
   여기서 $ \alpha $는 샤프닝의 정도를 조절하는 파라미터로, $\alpha > 1$일 때 분포는 더욱 '샤프'해지고, $\alpha < 1$일 때 분포는 더욱 '평탄'해집니다. $\alpha$ 값이 클수록 모델은 가장 가능성 높은 답변에 집중하게 됩니다.

2. **파워 샘플링 수식**:
   만약 $p(x_t | x_{<t})$가 토큰 $x_t$의 조건부 확률이고, $s(x_t)$가 중요도 점수라면, 파워 샘플링은 다음과 같이 가중치를 조정합니다:
   $$
   p'(x_t | x_{<t}) = \frac{p(x_t | x_{<t})^{s(x_t)}}{\sum_{x'} p(x' | x_{<t})^{s(x')}}
   $$
   여기서 $s(x_t) > 1$ 이면 긍정적 중요 토큰의 확률이 증가하고, $s(x_t) < 1$ 이면 부정적 중요 토큰의 확률이 감소합니다. 중요도 점수 $s(x_t)$는 다양한 방법으로 계산될 수 있으며, 예를 들어, 모델의 attention score를 활용할 수 있습니다.

3. **메트로폴리스-헤이스팅스 수식**:
   수락 확률은 제안된 상태의 확률과 현재 상태의 확률의 비율에 따라 결정됩니다:
   $$
   A(x' | x) = \min\left(1, \frac{p(x')}{p(x)}\right)
   $$
   여기서 $x'$는 제안된 상태, $x$는 현재 상태입니다. 수락 확률이 높을수록 새로운 샘플이 채택될 가능성이 높아집니다.

## 실험 설정

### 데이터셋

본 연구에서는 다양한 추론 벤치마크 데이터셋을 사용하여 제안된 방법론의 성능을 평가했습니다. 사용된 데이터셋은 다음과 같습니다:

- **MATH500**: 수학 문제 풀이 능력을 평가하기 위한 데이터셋. 고등학교 수준의 수학 문제로 구성되어 있습니다.
- **HumanEval**: 코드 생성 및 평가를 위한 데이터셋. Python 코드 생성 능력을 평가합니다.
- **GPQA**: 일반 상식 및 도메인 지식을 평가하기 위한 데이터셋. Google-Proprietary Question Answering 데이터셋입니다.
- **AlpacaEval 2.0**: 다양한 자연어 처리 태스크를 포함하는 종합적인 평가 데이터셋. LLM의 다양한 능력을 평가하는 데 사용됩니다.

### 평가 지표

모델의 성능은 다음과 같은 지표를 사용하여 평가되었습니다:

- **정확도(Accuracy)**: 생성된 답변의 정확성을 평가. 정답과 모델의 답변이 일치하는 비율을 측정합니다.
- **pass@k**: 생성된 k개의 샘플 중 정답이 하나 이상 포함될 확률. 모델이 생성한 여러 샘플 중 하나라도 정답이면 성공으로 간주합니다.

### 베이스라인

제안된 방법론의 성능을 평가하기 위해, 기존의 RL 후처리 방법론과 비교하였습니다. 이를 통해, 샘플링을 통한 성능 향상 여부를 검증하였습니다. 비교 대상 RL 방법론으로는 PPO(Proximal Policy Optimization) 등이 사용될 수 있습니다.

### 하이퍼파라미터

실험에 사용된 주요 하이퍼파라미터는 다음과 같습니다:

| 하이퍼파라미터 | 값 | 설명 |
|---------------|----|---------------------------------------------------|
| 샤프닝 파라미터 $\alpha$ | 2.0 | 확률 분포를 얼마나 강화할지 결정하는 파라미터 |
| 샘플 수 | 5 | MCMC를 통해 생성할 샘플의 수 |
| MCMC 반복 횟수 | 1000 | MCMC 알고리즘의 반복 횟수 |

## 실험 결과 분석

### 주요 결과

제안된 샘플링 알고리즘은 다양한 벤치마크에서 RL 후처리와 유사하거나 더 나은 성능을 보였습니다. 특히, HumanEval과 같은 도메인 외 추론 태스크에서 RL을 능가하는 결과를 보였습니다. 이는 제안된 방법이 모델의 일반화 능력을 향상시키는 데 효과적임을 시사합니다. 이는 RL 후처리가 특정 데이터셋에 과적합되는 문제를 해결할 수 있음을 의미합니다.

| 데이터셋 | RL 후처리 정확도 | 샘플링 정확도 | 성능 향상률(%) |
|----------|----------------|--------------|---------------|
| MATH500  | 85.0%          | 87.5%        | 2.94%         |
| HumanEval| 78.0%          | 80.5%        | 3.21%         |
| GPQA     | 82.5%          | 83.0%        | 0.61%         |

### Ablation Study

Ablation study를 통해, 각 구성 요소의 중요성을 평가하였습니다. 샤프닝 파라미터 $\alpha$의 변화에 따른 성능 변화를 분석한 결과, $\alpha = 2.0$일 때 가장 높은 성능을 보였습니다. 이는 적절한 샤프닝이 모델의 추론 능력을 극대화하는 데 기여함을 보여줍니다. 너무 작은 $\alpha$ 값은 효과가 미미하고, 너무 큰 $\alpha$ 값은 다양성을 저해할 수 있습니다.

## 비판적 평가

### 강점

1. **리소스 효율성**: 추가적인 훈련 없이도 기본 모델의 잠재력을 최대한 활용하여 높은 성능을 달성할 수 있습니다. 이는 LLM 운영 비용을 크게 절감할 수 있습니다.
2. **다양성 유지**: RL 후처리에서 발생할 수 있는 다양성 붕괴를 피하면서도 높은 정확도를 유지합니다. 이는 모델이 다양한 상황에 적응할 수 있도록 돕습니다.
3. **광범위한 적용 가능성**: 훈련, 검증 데이터셋, 검증기가 필요하지 않으며, 다양한 도메인과 태스크에 적용 가능합니다. 이는 LLM의 활용 범위를 넓히는 데 기여할 수 있습니다.

### 한계점 및 개선 방향

1. **모델 의존성**: 제안된 방법론은 기본 모델의 성능에 크게 의존하므로, 모델의 초기 성능이 낮을 경우 제한적인 성능 향상을 보일 수 있습니다. 따라서, 기본 모델의 성능을 향상시키는 연구가 선행되어야 합니다.
2. **복잡한 설정**: MCMC와 같은 복잡한 알고리즘을 사용하므로, 구현 및 조정이 어려울 수 있습니다. 이를 개선하기 위해, 보다 간단한 샘플링 기법을 개발할 필요가 있습니다. 예를 들어, Gibbs sampling과 같은 다른 MCMC 방법론을 시도해볼 수 있습니다.

### 재현성 평가

본 연구는 다양한 벤치마크에서 실험을 통해 제안된 방법론의 유효성을 입증하였으나, 복잡한 알고리즘과 설정으로 인해 재현성에 어려움이 있을 수 있습니다. 따라서, 재현성을 높이기 위해 상세한 구현 가이드를 제공하는 것이 중요합니다. 특히, MCMC 알고리즘의 초기화 방법과 수렴 조건에 대한 자세한 설명이 필요합니다.

## 향후 연구 방향

1. **모델 성능 향상**: 기본 모델의 성능을 더욱 향상시킬 수 있는 방법론을 탐구하여, 제안된 샘플링 방법론의 효과를 극대화할 수 있습니다. 예를 들어, 더 큰 규모의 데이터셋으로 사전 학습하거나, 새로운 모델 아키텍처를 개발할 수 있습니다.
2. **간단한 샘플링 기법 개발**: MCMC와 같은 복잡한 알고리즘을 대체할 수 있는 간단한 샘플링 기법을 개발하여, 구현의 용이성을 높일 수 있습니다. 예를 들어, top-k sampling이나 nucleus sampling과 같은 방법론을 적용해볼 수 있습니다.
3. **다양한 도메인 적용**: 제안된 방법론을 다양한 도메인에 적용하여, 그 유효성을 검증하고 확장할 수 있습니다. 예를 들어, 의료 분야나 금융 분야에 적용하여 성능을 평가할 수 있습니다.

## 실무 적용 가이드

### 구현 시 고려사항

1. **모델 선택**: 기본 모델의 성능이 제안된 방법론의 성능에 큰 영향을 미치므로, 높은 성능의 모델을 선택하는 것이 중요합니다. 예를 들어, GPT-3, LLaMA, PaLM과 같은 모델을 사용할 수 있습니다.
2. **하이퍼파라미터 조정**: 샤프닝 파라미터 $\alpha$와 샘플 수 등의 하이퍼파라미터를 적절히 조정하여, 최적의 성능을 달성할 수 있습니다. 하이퍼파라미터 최적화를 위해 Bayesian optimization과 같은 기법을 사용할 수 있습니다.
3. **복잡한 알고리즘 구현**: MCMC와 같은 복잡한 알고리즘을 구현할 때, 각 단계의 정확성을 검증하고 조정하는 것이 중요합니다. 특히, 수렴 조건을 만족하는지 확인해야 합니다.

### 팁

- **샘플링 다양성 유지**: 다양한 샘플을 생성하여, 모델의 다양성을 유지하고 다양한 관점을 포착할 수 있습니다. 샘플링 과정에서 temperature를 조절하여 다양성을 조절할 수 있습니다.
- **효율적인 리소스 사용**: 추가적인 훈련 없이도 높은 성능을 달성할 수 있으므로, 리소스를 효율적으로 사용할 수 있습니다. GPU 사용량을 줄이기 위해 quantization과 같은 기법을 사용할 수 있습니다.

## 결론

본 논문은 대규모 언어 모델의 추론 능력을 강화하기 위해, 기존의 RL 후처리 대신 순수 샘플링을 활용하는 새로운 방법론을 제안하였습니다. 제안된 샘플링 알고리즘은 다양한 벤치마크에서 RL 후처리와 유사하거나 더 나은 성능을 보였으며, 응답의 다양성도 유지했습니다. 이는 LLM의 잠재력을 최대한 활용하여 리소스 효율적인 추론 능력 향상에 기여할 수 있음을 시사합니다. 향후 연구에서는 보다 간단한 샘플링 기법 개발과 다양한 도메인 적용을 통해, 제안된 방법론의 유효성을 더욱 검증하고 확장할 수 있습니다. 특히, RL 후처리의 대안으로서, 그리고 LLM의 inference 단계에서 바로 적용 가능한 방법론으로서 그 가치가 높습니다.

## 참고 자료

- [논문 링크](https://arxiv.org/abs/2510.14901)
- 코드 저장소: [GitHub Repository](https://github.com/reasoning-with-sampling)
- 관련 자료: MCMC 기법, 강화 학습, 대규모 언어 모델 연구 문헌, Metropolis-Hastings 알고리즘, Gibbs sampling, top-k sampling, nucleus sampling