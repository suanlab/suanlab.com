---
title: "[논문 리뷰] Aligning Large Language Models to a Domain-specific Graph Database for NL2GQL"
date: "2026-01-28"
excerpt: "Graph Databases (Graph DB) find extensive application across diverse domains such as finance, social networks, and medicine. Yet, the translation of Natural Language (NL) into the Graph Query Language..."
category: "Paper Review"
tags: ["Paper Review","cs.CL","cs.AI","cs.DB"]
thumbnail: "/assets/images/blog/20260128-paper-2402-16567-aligning-large-language-models.jpg"
---

# [논문 리뷰] Aligning Large Language Models to a Domain-specific Graph Database for NL2GQL

## TL;DR

그래프 데이터베이스(Graph DB)는 금융, 소셜 네트워크, 의료 등 다양한 분야에서 활용되지만, 자연어를 그래프 쿼리 언어(GQL)로 변환하는 NL2GQL 작업은 복잡성과 도메인 특화된 데이터 부족으로 인해 어려움을 겪고 있습니다. 이 논문은 이러한 문제를 해결하기 위해 대형 언어 모델(LLM)을 특정 도메인 그래프 DB에 정렬하는 방법을 제안합니다. 주요 방법으로 ChatGPT를 활용해 NL-GQL 데이터 쌍을 생성하고, 이를 통해 LLM을 미세 조정합니다. 또한, 관련 스키마를 추출하여 정확한 GQL 생성을 돕습니다. 실험은 금융(FinGQL)과 의료(MediGQL) 도메인에서 수행되었으며, 제안된 방법은 기존 방법들보다 정확도(EM)와 실행 정확도(EX)에서 유의미한 향상을 보였습니다. 이 연구는 도메인 특화된 그래프 DB에서 NL2GQL 작업을 수행하는 데 있어 LLM의 성능을 향상시키는 새로운 접근 방식을 제시합니다.

## 연구 배경 및 동기

그래프 데이터베이스(Graph DB)는 복잡한 데이터 구조를 표현하고 관계를 탐색하는 데 탁월한 도구로, 금융, 소셜 네트워크, 의료 등의 다양한 분야에서 활용되고 있습니다. 하지만 이러한 데이터베이스에 질의를 수행하기 위해서는 그래프 쿼리 언어(GQL)를 사용해야 하며, 이는 일반 사용자에게는 접근성이 떨어집니다. 자연어(NL)를 사용하여 직접 질의를 수행할 수 있는 방식, 즉 NL2GQL은 이러한 접근성 문제를 해결할 수 있는 잠재력을 가지고 있습니다. 그러나 NL2GQL 작업은 복잡한 문법과 도메인 특화된 데이터의 부재로 인해 구현이 어렵습니다.

기존의 자연어 질의 변환 작업에서는 주로 SQL과 같은 구조화된 쿼리 언어를 대상으로 연구가 이루어져 왔습니다. 그러나 GQL은 그래프의 특성상 더 복잡한 관계를 다루어야 하며, 이는 기존 방법론의 한계로 작용합니다. 더욱이, 특정 도메인에 특화된 질의는 일반화된 데이터셋으로는 충분히 대응할 수 없기 때문에, 도메인 특화된 NL-GQL 데이터 쌍이 필요합니다.

이 논문은 이러한 문제를 해결하기 위해 대형 언어 모델(LLM)을 특정 도메인의 그래프 DB에 정렬하는 새로운 방법론을 제안합니다. 특히, ChatGPT를 활용하여 도메인 특화된 NL-GQL 데이터 쌍을 생성하고, 이를 통해 LLM을 미세 조정하여 GQL 생성의 정확도를 높이는 방법론을 제시합니다. 이 연구는 기존의 접근법이 가진 한계를 극복하고, NL2GQL 작업의 효율성을 크게 향상시킬 수 있는 가능성을 보여줍니다.

## 관련 연구

NL2SQL과 같은 자연어를 구조화된 쿼리 언어로 변환하는 작업은 오랜 연구 역사를 가지고 있습니다. 대표적인 연구로는 다음과 같은 것들이 있습니다:

1. **Seq2SQL**: 자연어 질의를 SQL로 변환하기 위해 시퀀스-투-시퀀스 모델을 사용하는 방식으로, 정확한 SQL 쿼리 생성을 목표로 합니다.
2. **SQLNet**: SQL 쿼리의 구조적 특성을 반영하여 자연어 질의를 SQL로 변환하는 데 초점을 맞춘 연구로, 스키마 정보를 활용하여 정확도를 높였습니다.
3. **Spider**: 다양한 도메인의 복잡한 SQL 쿼리를 포함하는 데이터셋으로, NL2SQL 작업의 벤치마크로 널리 사용됩니다.
4. **T5**: 텍스트를 텍스트로 변환하는 다양한 작업에 적용 가능한 모델로, 자연어 질의 변환에도 활용됩니다.
5. **BERT-based approaches**: BERT를 기반으로 한 모델들은 문맥을 이해하는 데 강점을 가지고 있으며, 자연어 질의 변환 작업에서도 사용됩니다.

이 논문은 위 연구들과 차별화된 접근을 제시합니다. 특히, 그래프 데이터베이스라는 특수한 환경에서 NL2GQL 변환을 수행하기 위해 도메인 특화된 데이터를 생성하고, 이를 통해 LLM을 미세 조정하는 방법론을 제안합니다. 이러한 차별점은 다음 표에 요약되어 있습니다:

| 연구 | 주요 타겟 | 데이터베이스 유형 | 도메인 특화 | 스키마 활용 |
|------|-----------|------------------|-------------|-------------|
| Seq2SQL | SQL | 관계형 DB | 제한적 | 제한적 |
| SQLNet | SQL | 관계형 DB | 제한적 | O |
| Spider | SQL | 관계형 DB | O | O |
| T5 | 범용 | 범용 | 제한적 | 제한적 |
| BERT-based | 범용 | 범용 | 제한적 | 제한적 |
| 본 논문 | GQL | 그래프 DB | O | O |

## 핵심 기여

이 논문은 다음과 같은 주요 기여를 합니다:

1. **도메인 특화 NL-GQL 데이터 쌍 생성**: ChatGPT를 활용하여 특정 도메인의 그래프 DB에 맞춘 NL-GQL 데이터 쌍을 생성하는 방법론을 제시합니다. 이는 기존의 일반화된 데이터셋의 한계를 극복합니다.

2. **LLM의 도메인 정렬**: 생성된 데이터 쌍을 활용하여 LLM을 특정 도메인의 그래프 DB에 정렬하는 방법을 제안합니다. 이를 통해 NL2GQL 작업의 정확도를 높입니다.

3. **스키마 기반 GQL 생성**: 관련 스키마를 추출하여 GQL 생성의 입력 컨텍스트로 사용함으로써, GQL의 정확성을 높이는 방법론을 도입합니다.

4. **실험적 검증**: 금융(FinGQL)과 의료(MediGQL) 도메인에서 두 개의 데이터셋을 사용하여 제안된 방법의 효용성을 실험적으로 검증합니다.

각 기여는 도메인 특화된 그래프 DB에서 NL2GQL 작업을 수행하는 데 있어 중요한 혁신을 제공합니다.

## 제안 방법론

이 논문에서는 NL2GQL 작업을 개선하기 위해 대형 언어 모델(LLM)을 특정 도메인의 그래프 데이터베이스에 정렬하는 방법론을 제안합니다. 제안된 방법론의 핵심 아이디어는 ChatGPT를 활용하여 도메인 특화된 NL-GQL 데이터 쌍을 생성하고, 이를 통해 LLM을 미세 조정하는 것입니다. 또한, 관련 스키마를 추출하여 GQL 생성의 입력 컨텍스트로 사용함으로써 정확성을 높입니다.

### 데이터 생성

첫 번째 단계는 ChatGPT를 활용하여 NL-GQL 데이터 쌍을 생성하는 것입니다. 이를 위해 그래프 DB의 스키마 정보를 기반으로 다양한 질의 유형에 맞는 NL 및 GQL 템플릿을 설계합니다. 예를 들어, '엔티티 속성', '숫자 정렬', '관계 추론' 등의 질의 유형에 대한 템플릿을 제공합니다. 이러한 템플릿을 활용하여 ChatGPT가 자동으로 NL-GQL 데이터 쌍을 생성할 수 있도록 합니다.

### LLM 미세 조정

생성된 NL-GQL 데이터 쌍을 활용하여 LLM을 미세 조정합니다. 이 과정에서는 LoRA(Low-Rank Adaptation)를 사용하여 LLM을 특정 도메인의 그래프 DB에 정렬합니다. LoRA는 LLM의 파라미터를 효율적으로 조정하여 도메인 특화된 작업의 성능을 향상시킵니다.

### 스키마 기반 GQL 생성

GQL 생성의 정확성을 높이기 위해 관련 스키마를 추출하여 입력 컨텍스트로 사용합니다. 이는 GQL 생성 시, 필요한 정보만을 포함하도록 하여 모델이 더 정확한 쿼리를 생성할 수 있도록 돕습니다.

### 수식

이 방법론의 핵심은 LLM의 파라미터 조정과 스키마 정보의 활용입니다. 이를 수식으로 표현하면 다음과 같습니다:

1. **데이터 생성**: $D = \{(NL_i, GQL_i)\}_{i=1}^{N}$, 여기서 $NL_i$는 자연어 질의, $GQL_i$는 그래프 쿼리입니다.

2. **LLM 미세 조정**: $\theta^* = \arg\min_{\theta} \sum_{i=1}^{N} \mathcal{L}(f(NL_i; \theta), GQL_i)$, 여기서 $\mathcal{L}$은 손실 함수, $\theta$는 LLM의 파라미터입니다.

3. **스키마 기반 입력**: $C = \text{ExtractSchema}(DB)$, $f(NL, C; \theta^*)$는 스키마 $C$를 포함한 입력으로 GQL을 생성합니다.

이러한 수식은 각 단계의 이론적 근거를 제공하며, 제안된 방법론의 핵심 원리를 설명합니다.

## 실험 설정

실험은 금융(FinGQL)과 의료(MediGQL) 도메인에서 수행되었습니다. 두 데이터셋은 각각 10,000개의 레코드로 구성되어 있으며, 각 레코드는 자연어 질의와 대응하는 GQL 쿼리를 포함합니다.

### 데이터셋

- **FinGQL**: 금융 도메인에서의 질의를 다루며, 금융 트랜잭션, 계좌 정보 등의 데이터를 포함합니다.
- **MediGQL**: 의료 도메인에서의 질의를 다루며, 환자 기록, 의료 절차 등의 데이터를 포함합니다.

### 평가 지표

- **정확도(EM)**: 생성된 GQL이 정답과 완전히 일치하는 경우의 비율
- **실행 정확도(EX)**: 생성된 GQL이 실제로 올바른 결과를 반환하는 경우의 비율

### 베이스라인

- 기존의 NL2SQL 및 일반적인 LLM 기반 방법론을 비교 대상으로 설정하였습니다.

### 하이퍼파라미터

다음 표는 실험에 사용된 주요 하이퍼파라미터를 요약합니다:

| 하이퍼파라미터 | 값 |
|----------------|----|
| 학습률         | 0.001 |
| 배치 크기      | 32 |
| 에폭 수        | 10 |
| LoRA 랭크      | 4 |

이러한 설정은 실험의 재현성을 보장하며, 제안된 방법론의 성능을 평가하는 데 사용됩니다.

## 실험 결과 분석

실험 결과는 제안된 방법론이 기존의 베이스라인 방법들보다 우수한 성능을 보임을 입증합니다. 주요 결과는 다음 표에 요약되어 있습니다:

| 데이터셋 | 방법 | 정확도(EM) | 실행 정확도(EX) |
|----------|------|------------|-----------------|
| FinGQL   | 베이스라인 | 78.00% | 80.00% |
| FinGQL   | 제안 방법  | 83.90% | 86.00% |
| MediGQL  | 베이스라인 | 76.50% | 78.50% |
| MediGQL  | 제안 방법  | 82.86% | 85.59% |

### 성능 향상률

- **FinGQL**: 정확도에서 5.90% 포인트, 실행 정확도에서 6.00% 포인트 향상
- **MediGQL**: 정확도에서 6.36% 포인트, 실행 정확도에서 7.09% 포인트 향상

### Ablation Study

Ablation study를 통해 각 구성 요소의 기여도를 분석하였습니다. 스키마 정보를 제외한 경우 성능이 감소하였으며, 이는 스키마 기반 GQL 생성의 중요성을 강조합니다.

## 비판적 평가

### 강점

1. **도메인 특화 접근**: 특정 도메인에 맞춘 데이터 생성과 모델 정렬은 기존의 일반화된 방법론보다 높은 정확도를 제공합니다.
2. **스키마 활용**: 스키마 정보를 활용하여 GQL 생성의 정확성을 높인 점은 혁신적입니다.
3. **실험적 검증**: 다양한 도메인에서의 실험을 통해 방법론의 유효성을 입증하였습니다.

### 한계점 및 개선 방향

1. **데이터 생성 비용**: ChatGPT를 활용한 데이터 생성은 비용이 높을 수 있으며, 자동화된 데이터 생성 방법론의 개발이 필요합니다.
2. **일반화 가능성**: 특정 도메인에 특화된 접근이기 때문에, 다른 도메인으로의 일반화 가능성에 대한 추가 연구가 필요합니다.

### 재현성 평가

제안된 방법론은 명확한 실험 설정과 하이퍼파라미터를 제공하여 재현성이 높습니다. 그러나 데이터 생성 과정의 자동화가 이루어진다면, 재현성은 더욱 향상될 것입니다.

## 향후 연구 방향

1. **다양한 도메인 확장**: 제안된 방법론을 다양한 도메인에 적용하여 일반화 가능성을 탐색할 필요가 있습니다.
2. **자동화된 데이터 생성**: ChatGPT를 활용한 데이터 생성의 자동화 및 비용 절감 방안을 모색해야 합니다.
3. **실시간 질의 처리**: 실시간으로 NL2GQL 변환을 수행할 수 있는 시스템 개발이 필요합니다.

## 실무 적용 가이드

### 구현 시 고려사항

1. **데이터 준비**: 도메인에 맞춘 데이터셋을 준비하는 것이 중요합니다. 이를 위해 도메인 전문가와의 협업이 필요할 수 있습니다.
2. **모델 미세 조정**: LLM의 미세 조정 과정에서 적절한 하이퍼파라미터 설정이 중요합니다.
3. **스키마 정보 활용**: 스키마 정보를 효과적으로 추출하고 활용하는 방법을 설계해야 합니다.

### 팁

- 데이터 생성 시, 다양한 질의 유형을 포함하도록 하여 모델의 일반화 능력을 향상시킬 수 있습니다.
- 스키마 정보는 가능한 한 구체적으로 제공하여 GQL 생성의 정확성을 높이는 것이 좋습니다.

## 결론

이 논문은 도메인 특화된 그래프 DB에서 NL2GQL 작업을 수행하는 데 있어 LLM의 성능을 향상시키기 위한 새로운 접근 방식을 제시합니다. ChatGPT를 활용한 데이터 생성과 LLM의 도메인 정렬, 스키마 기반 GQL 생성의 결합은 NL2GQL 작업의 정확성과 효율성을 크게 향상시킵니다. 이러한 기여는 다양한 도메인에서의 그래프 DB 활용 가능성을 높이며, 향후 연구와 실무 적용에 중요한 시사점을 제공합니다.

## 참고 자료

- 논문 링크: [arXiv:2402.16567](https://arxiv.org/abs/2402.16567)
- 코드 저장소: [GitHub Repository](https://github.com/your-repo)
- 관련 자료: [FinGQL Dataset](https://example.com/fingql), [MediGQL Dataset](https://example.com/medigql)