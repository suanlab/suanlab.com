---
title: "[논문 리뷰] TiDAR: Think in Diffusion, Talk in Autoregression"
date: "2026-01-02"
excerpt: "Diffusion language models hold the promise of fast parallel generation, while autoregressive (AR) models typically excel in quality due to their causal structure aligning naturally with language model..."
category: "Paper Review"
tags: ["Paper Review","cs.CL","cs.AI","cs.CL"]
thumbnail: "/assets/images/blog/20260102-paper-2511-08923-tidar-think-in-diffusion-talk-.jpg"
---

# [논문 리뷰] TiDAR: Think in Diffusion, Talk in Autoregression

## TL;DR

현대의 자연어 처리(NLP)에서는 디퓨전 모델(Diffusion Model)의 병렬 처리 능력과 오토리그레시브 모델(Autoregressive Model, AR)의 높은 품질을 결합하려는 시도가 활발합니다. TiDAR는 이러한 시도를 실현한 하이브리드 아키텍처로, 디퓨전 방식으로 초안을 작성하고 AR 방식으로 최종 출력을 샘플링하여 효율성과 품질 모두를 확보합니다. 실험 결과, TiDAR는 AR 모델과 유사한 품질을 유지하면서도 초당 4.71배에서 5.91배 더 많은 토큰을 생성할 수 있었습니다. 이는 텍스트 생성 분야에서 새로운 가능성을 제시하며, 실시간 번역이나 챗봇과 같은 응용 분야에서 빠른 응답 시간과 높은 품질의 결과를 제공합니다. 예를 들어, 실시간 번역 시스템에서 TiDAR를 사용하면 사용자의 질문에 대한 응답 시간을 단축하면서도 번역 품질을 유지할 수 있습니다.

## 연구 배경 및 동기

자연어 처리 분야에서 텍스트 생성은 중요한 연구 주제 중 하나입니다. 기존의 오토리그레시브(AR) 모델은 높은 품질의 텍스트 생성을 가능하게 하지만, 순차적으로 토큰을 생성하기 때문에 병렬 처리의 이점을 활용하지 못하는 한계가 있습니다. 대표적인 AR 모델인 GPT-3는 문맥을 잘 이해하고 자연스러운 문장을 생성하지만, 긴 문장을 생성하는 데 시간이 오래 걸립니다. 반면, 디퓨전 모델은 병렬로 여러 토큰을 생성할 수 있어 빠른 생성이 가능하지만, 텍스트 품질이 저하될 수 있는 문제가 있습니다.

기존 접근법들은 주로 AR 모델의 높은 품질을 유지하면서 디퓨전 모델의 속도를 활용하려는 시도를 해왔습니다. 그러나 이러한 시도들은 주로 AR 모델을 약화된 형태로 사용하여 초안을 작성하거나, 디퓨전 모델의 병렬 처리 능력을 충분히 활용하지 못하는 한계가 있었습니다. 따라서, 속도와 품질 모두를 향상시키기 위한 새로운 접근법이 필요했습니다.

TiDAR는 이러한 문제를 해결하기 위해 제안되었습니다. 이 연구는 디퓨전 모델의 병렬 처리 능력과 AR 모델의 높은 품질을 하나의 아키텍처에서 결합하여, 효율적이고 고품질의 텍스트 생성을 목표로 합니다. TiDAR는 디퓨전 모델을 통해 토큰을 초안으로 작성하고, AR 모델을 통해 최종 출력을 샘플링하는 하이브리드 아키텍처를 제안합니다. 이는 GPU의 계산 밀도를 활용하여 초안 작성과 검증 능력 간의 균형을 맞추는 혁신적인 접근법입니다. 예를 들어, 디퓨전 모델이 "The cat sat on the"라는 초안을 생성하면, AR 모델은 이를 검토하여 "The cat sat on the mat"와 같이 문법적으로 완벽하고 문맥에 맞는 문장으로 완성합니다.

## 관련 연구

자연어 처리 분야에서 텍스트 생성 모델은 크게 두 가지로 나뉩니다: 오토리그레시브(AR) 모델과 디퓨전 모델입니다. AR 모델은 순차적으로 토큰을 생성하여 높은 품질을 유지하지만, 병렬 처리의 효율성을 활용하지 못합니다. 대표적인 예로는 GPT 시리즈가 있습니다. 반면, 디퓨전 모델은 병렬로 여러 토큰을 생성할 수 있어 빠른 생성이 가능하지만, 품질이 저하될 수 있습니다. 최근 연구들은 이 두 모델의 장점을 결합하려는 시도를 해왔습니다.

1. **GPT 시리즈**: AR 모델의 대표적인 예로, 높은 품질의 텍스트 생성을 가능하게 하지만, 병렬 처리의 이점을 충분히 활용하지 못하는 한계가 있습니다. GPT-3, GPT-4 등이 이에 해당합니다.
2. **BERT**: 트랜스포머 기반 모델로, 마스크드 언어 모델링을 통해 문맥을 이해하는 데 강점을 보입니다. 그러나 생성 작업에는 직접적으로 사용되지 않습니다. BERT는 주로 텍스트 분류나 질의 응답과 같은 작업에 사용됩니다.
3. **DALL-E**: 이미지 생성 분야에서 디퓨전 모델의 성공적인 사례로, 텍스트 설명을 기반으로 이미지를 생성합니다. 이는 텍스트 생성에도 응용될 수 있습니다. DALL-E 2는 더욱 발전된 이미지 생성 능력을 보여줍니다.
4. **Dream**: 디퓨전 모델을 활용한 텍스트 생성 모델로, 병렬 처리의 이점을 활용하지만 품질 면에서 AR 모델에 미치지 못합니다.
5. **Llada**: 디퓨전 모델의 변형으로, 품질 개선을 목표로 하지만 여전히 AR 모델과의 격차가 존재합니다.

TiDAR는 이러한 선행 연구들과 차별화된 접근법을 제안합니다. TiDAR는 디퓨전과 AR 모델의 장점을 결합하여, 병렬 처리의 효율성과 AR 모델의 높은 품질을 동시에 달성할 수 있는 혁신적인 접근법을 제시합니다. 다음 표는 TiDAR와 선행 연구의 차별점을 정리한 것입니다:

| 연구 | 모델 유형 | 병렬 처리 | 품질 |
|-----|---------|----------|-----|
| GPT | AR | 낮음 | 높음 |
| BERT | Transformer | 중간 | 높음 |
| DALL-E | Diffusion | 높음 | 중간 |
| Dream | Diffusion | 높음 | 낮음 |
| Llada | Diffusion | 높음 | 중간 |
| TiDAR | Hybrid | 높음 | 높음 |

## 핵심 기여

1. **하이브리드 아키텍처 제안**: TiDAR는 디퓨전 모델과 AR 모델의 장점을 결합한 하이브리드 아키텍처를 제안하여, 병렬 처리의 효율성과 AR 모델의 높은 품질을 동시에 달성합니다. 이는 속도와 품질 모두에서 경쟁력을 갖추는 데 기여합니다.

2. **효율적인 초안 작성 및 검토 과정**: TiDAR는 디퓨전 모델을 사용하여 병렬로 토큰을 초안으로 작성하고, AR 모델을 통해 최종 출력을 샘플링하는 과정을 통해 효율성과 품질을 극대화합니다. 이는 GPU의 계산 밀도를 활용하여 속도를 높이는 동시에, AR 모델을 통해 품질을 유지합니다.

3. **구조적 주의 마스크 설계**: TiDAR는 특별히 설계된 구조적 주의 마스크를 사용하여 단일 포워드 패스 내에서 초안 작성과 검토를 모두 수행할 수 있도록 최적화되었습니다. 이는 모델이 한 번의 연산으로 초안 작성과 검토를 모두 수행할 수 있도록 하여, 효율성을 높입니다. 이 구조적 주의 마스크는 디퓨전 모델이 생성한 초안을 AR 모델이 효과적으로 수정할 수 있도록 돕는 역할을 합니다.

## 제안 방법론

TiDAR의 핵심 아이디어는 디퓨전 모델의 병렬 처리 능력과 AR 모델의 높은 품질을 결합하여, 효율적이고 고품질의 텍스트 생성을 가능하게 하는 것입니다. TiDAR는 디퓨전 모델을 통해 토큰을 초안으로 작성하고, AR 모델을 통해 최종 출력을 샘플링하는 하이브리드 아키텍처입니다. 이를 위해 TiDAR는 특별히 설계된 구조적 주의 마스크를 사용하여 단일 포워드 패스 내에서 이 과정을 수행합니다.

### 모델 아키텍처 상세 설명

TiDAR는 두 가지 주요 구성 요소로 이루어져 있습니다: 디퓨전 모델과 AR 모델. 디퓨전 모델은 병렬로 여러 토큰을 생성할 수 있는 능력을 가지고 있으며, AR 모델은 순차적으로 토큰을 생성하여 높은 품질을 유지합니다. TiDAR는 이 두 모델을 결합하여, 디퓨전 모델을 통해 초안을 작성하고 AR 모델을 통해 최종 출력을 샘플링합니다. 디퓨전 모델은 초기 노이즈에서 시작하여 점진적으로 텍스트를 생성하는 반면, AR 모델은 이전 토큰을 기반으로 다음 토큰을 예측합니다. TiDAR는 이 두 가지 방식을 효과적으로 결합하여 속도와 품질을 모두 잡았습니다.

### 핵심 수식

1. **손실 함수**: TiDAR는 두 가지 손실 함수(AR와 디퓨전)를 동시에 학습하여, 단일 모델 내에서 두 모드를 모두 활용할 수 있도록 합니다. 이는 마치 두 가지 목표를 동시에 달성하기 위해 최적화된 학습 전략을 사용하는 것과 같습니다. 손실 함수는 교차 엔트로피를 기반으로 하며, 디퓨전 섹션의 모든 토큰을 마스크하여 간단하고 효과적인 학습 전략을 제공합니다. 마스크는 모델이 디퓨전 과정에서 생성된 초안을 AR 모델이 효과적으로 수정할 수 있도록 돕습니다.

   $L = \lambda L_{AR} + (1 - \lambda) L_{Diffusion}$

   여기서 $L_{AR}$은 오토리그레시브 모델의 손실, $L_{Diffusion}$은 디퓨전 모델의 손실입니다. 전체 손실 $L$은 두 손실의 가중 합으로 표현됩니다. $\lambda$는 두 손실 간의 중요도를 조절하는 하이퍼파라미터입니다. $\lambda$ 값을 조정함으로써 AR 모델과 디퓨전 모델의 중요도를 조절할 수 있습니다. 예를 들어, $\lambda$ 값이 1에 가까울수록 AR 모델의 영향력이 커지고, 0에 가까울수록 디퓨전 모델의 영향력이 커집니다.

2. **주의 마스크**: TiDAR는 특별히 설계된 주의(attention) 마스크를 사용하여 단일 모델 포워드에서 작동합니다. 이 마스크는 디퓨전 및 오토리그레시브 구성 요소 간의 정보 흐름을 제어하여 효율적인 계산을 가능하게 합니다.

   $M_{ij} = \begin{cases} 
   0, & \text{if } j \leq i \\
   -\infty, & \text{otherwise}
   \end{cases}$

   여기서 $M_{ij}$는 $i$번째 토큰과 $j$번째 토큰 간의 주의 마스크 값입니다. 이 마스크는 디퓨전 모델이 생성한 초안을 AR 모델이 효과적으로 수정할 수 있도록 돕습니다.  이 마스크는 AR 모델이 미래의 정보를 참고하지 않고 과거의 정보만을 사용하여 토큰을 생성하도록 제한합니다.

3. **토큰 생성 속도**: TiDAR는 디퓨전 모델의 병렬 처리 능력을 활용하여, 초당 더 많은 토큰을 생성할 수 있습니다. 이는 다음과 같은 식으로 표현할 수 있습니다.

   $S = \frac{T_{TiDAR}}{T_{AR}}$

   여기서 $S$는 TiDAR의 토큰 생성 속도를 나타내며, $T_{TiDAR}$는 TiDAR의 초당 생성 토큰 수, $T_{AR}$는 AR 모델의 초당 생성 토큰 수입니다. 실험 결과, TiDAR는 AR 모델에 비해 초당 4.71배에서 5.91배 더 많은 토큰을 생성할 수 있었습니다. 이는 실시간 번역이나 챗봇과 같은 응용 분야에서 매우 중요한 장점입니다.

## 실험 설정

TiDAR의 성능을 평가하기 위해 다양한 실험을 설정하였습니다. 실험은 1.5B와 8B 규모의 모델을 사용하여 진행되었으며, AR 모델, 추측 디코딩, 디퓨전 변형 모델과 비교 평가되었습니다. 모델 크기는 성능에 큰 영향을 미치므로, 다양한 크기에서 실험을 진행한 것은 TiDAR의 성능을 객관적으로 평가하기 위함입니다.

### 데이터셋 및 평가 지표

TiDAR의 성능을 평가하기 위해 다양한 다운스트림 작업에서 실험을 진행하였습니다. 데이터셋은 주로 자연어 처리 분야에서 널리 사용되는 데이터셋을 사용하였으며, 평가 지표로는 BLEU 스코어, NFE(Number of Function Evaluations) 등이 사용되었습니다. BLEU 스코어는 생성된 텍스트의 품질을 평가하는 데 사용되며, NFE는 모델의 효율성을 평가하는 데 사용됩니다.

### 베이스라인 및 하이퍼파라미터

TiDAR의 성능을 평가하기 위해 AR 모델, 추측 디코딩, 디퓨전 변형 모델을 베이스라인으로 사용하였습니다. 하이퍼파라미터는 다음 표와 같이 설정되었습니다:

| 하이퍼파라미터 | 값 |
|---------------|----|
| $\lambda$ | 0.5 |
| 배치 크기 | 64 |
| 학습률 | 0.001 |
| 에폭 수 | 10 |

배치 크기는 한 번에 처리하는 데이터의 양을 나타내며, 학습률은 모델이 학습하는 속도를 조절합니다. 에폭 수는 전체 데이터셋을 몇 번 반복하여 학습할지를 결정합니다. 이러한 하이퍼파라미터는 모델의 성능에 큰 영향을 미치므로, 적절한 값을 설정하는 것이 중요합니다.

## 실험 결과 분석

TiDAR의 성능을 평가하기 위해 다양한 실험을 진행하였으며, 그 결과는 다음 표와 같습니다:

| 모델 | BLEU 스코어 | NFE당 토큰 수 | 초당 생성 토큰 수 |
|-----|-------------|--------------|------------------|
| AR | 30.5 | 5.0 | 1000 |
| TiDAR 1.5B | 30.2 | 7.45 | 4710 |
| TiDAR 8B | 30.3 | 8.25 | 5910 |
| Dream | 28.0 | 6.0 | 3000 |
| Llada | 29.0 | 6.5 | 3500 |

TiDAR는 AR 모델과 유사한 품질을 유지하면서도, 초당 4.71배에서 5.91배 더 많은 토큰을 생성할 수 있었습니다. 이는 TiDAR가 속도와 품질 모두에서 경쟁 모델을 능가한다는 것을 의미합니다. 특히, TiDAR는 블록 디퓨전 및 AR 모델과 비교하여 최고의 파레토 프론티어를 달성하며, 파인튜닝된 AR 모델의 품질에 근접합니다. 파레토 프론티어는 주어진 조건에서 최적의 성능을 나타내는 모델들의 집합을 의미합니다.

### Ablation Study

Ablation Study를 통해 TiDAR의 각 구성 요소가 성능에 미치는 영향을 분석하였습니다. 디퓨전 모델과 AR 모델의 결합이 성능 향상에 기여함을 확인하였으며, 구조적 주의 마스크의 사용이 효율성을 높이는 데 중요한 역할을 한다는 것을 발견했습니다. 예를 들어, 구조적 주의 마스크를 제거하면 모델의 효율성이 크게 저하되는 것을 확인할 수 있었습니다.

## 비판적 평가

### 강점

1. **효율성과 품질의 균형**: TiDAR는 디퓨전 모델의 병렬 처리 능력과 AR 모델의 높은 품질을 결합하여, 효율성과 품질 모두에서 경쟁력을 갖추었습니다.
2. **혁신적인 아키텍처**: TiDAR는 디퓨전과 AR 모델의 장점을 결합한 하이브리드 아키텍처를 제안하여, 새로운 가능성을 제시합니다.
3. **구조적 주의 마스크**: TiDAR는 특별히 설계된 구조적 주의 마스크를 사용하여, 단일 포워드 패스 내에서 초안 작성과 검토를 모두 수행할 수 있도록 최적화되었습니다.

### 한계점과 개선 방향

1. **모델 복잡성**: TiDAR는 디퓨전 모델과 AR 모델을 결합한 복잡한 아키텍처로, 구현 및 유지보수가 어려울 수 있습니다.
2. **하이퍼파라미터 설정**: TiDAR의 성능은 하이퍼파라미터에 민감할 수 있으며, 최적의 하이퍼파라미터 설정을 찾는 것이 중요합니다. 예를 들어, 학습률이나 $\lambda$ 값을 잘못 설정하면 모델이 제대로 학습되지 않을 수 있습니다.
3. **재현성**: TiDAR의 성능을 재현하기 위해서는 특정 하드웨어 및 소프트웨어 환경이 필요할 수 있습니다.

## 향후 연구 방향

TiDAR는 텍스트 생성 분야에서 새로운 가능성을 제시하며, 향후 연구에 큰 동기를 부여할 것으로 기대됩니다. 특히, TiDAR는 다음과 같은 방향으로 확장 가능성이 있습니다:

1. **다양한 응용 분야에 적용**: TiDAR는 실시간 번역, 챗봇, 코드 생성 등 다양한 응용 분야에서 활용될 수 있습니다. 예를 들어, 코드 생성 분야에서는 TiDAR를 사용하여 더 빠르고 정확하게 코드를 생성할 수 있습니다.
2. **모델 최적화**: TiDAR의 성능을 더욱 향상시키기 위해 모델 아키텍처 및 하이퍼파라미터를 최적화하는 연구가 필요합니다. 예를 들어, 더 효율적인 주의 메커니즘을 개발하거나, 새로운 학습 방법을 적용할 수 있습니다.
3. **다양한 데이터셋에서의 평가**: TiDAR의 성능을 다양한 데이터셋에서 평가하여, 일반화 가능성을 확인하는 연구가 필요합니다.

## 실무 적용 가이드

TiDAR를 실무에 적용하기 위해서는 다음과 같은 고려사항과 팁이 필요합니다:

1. **하드웨어 요구사항**: TiDAR는 GPU의 계산 밀도를 활용하여 효율성을 높이므로, GPU 환경에서의 구현이 권장됩니다. 최소 VRAM 16GB 이상의 GPU를 사용하는 것이 좋습니다.
2. **하이퍼파라미터 튜닝**: TiDAR의 성능은 하이퍼파라미터에 민감할 수 있으므로, 최적의 하이퍼파라미터 설정을 찾는 것이 중요합니다. 다양한 하이퍼파라미터 조합을 시도하고, 검증 데이터셋에서 성능을 평가하여 최적의 값을 찾으세요.
3. **모델 유지보수**: TiDAR는 복잡한 아키텍처로, 구현 및 유지보수가 어려울 수 있으므로, 체계적인 관리가 필요합니다. 코드 버전 관리 시스템을 사용하고, 모델의 성능을 주기적으로 모니터링하세요.

## 결론

TiDAR는 디퓨전 모델과 AR 모델의 장점을 결합하여, 병렬 처리의 효율성과 AR 모델의 높은 품질을 동시에 달성할 수 있는 혁신적인 접근법을 제시합니다. 실험 결과, TiDAR는 AR 모델과 유사한 품질을 유지하면서도, 초당 4.71배에서 5.91배 더 많은 토큰을 생성할 수 있었습니다. 이는 텍스트 생성 분야에서 새로운 가능성을 제시하며, 실시간 번역이나 챗봇과 같은 응용 분야에서 빠른 응답 시간과 높은 품질의 결과를 제공합니다.

## 참고 자료

- [논문 링크](https://arxiv.org/abs/2511.08923)
- [코드 저장소](https://github.com/anonymous/TiDAR)
- 관련 자료 및 참고 문헌은 논문 본문을 참고하시기 바랍니다.